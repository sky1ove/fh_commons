# Form


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Setup

``` python
hdrs = bootstrap_hdrs()+download_js()+datatable_hdrs()
```

``` python
show(*hdrs)
```

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script><link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
<script>
            document.addEventListener('htmx:load', function() {
                var tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
                var tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));
            });
        </script><script src="./imports/download_csv_svg.js"></script><script src="https://code.jquery.com/jquery-3.7.1.js"></script><script src="https://cdn.datatables.net/2.1.5/js/dataTables.js"></script><script src="https://cdn.datatables.net/2.1.5/js/dataTables.bootstrap5.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/2.1.5/css/dataTables.bootstrap5.css">
<script>if (window.htmx) htmx.process(document.body)</script>

``` python
from ngrok_token import *
url = start_ngrok(token)
```

    ngrok tunnel opened at: https://a223-3-238-95-91.ngrok-free.app

``` python
app,rt = fast_app(pico=False,hdrs=hdrs)
server = JupyUvi(app)
```

<script>
document.body.addEventListener('htmx:configRequest', (event) => {
    if(event.detail.path.includes('://')) return;
    htmx.config.selfRequestsOnly=false;
    event.detail.path = `${location.protocol}//${location.hostname}:8000${event.detail.path}`;
});
</script>

## File upload & receive

### Upload csv/excel file

------------------------------------------------------------------------

<a
href="https://github.com/sky1ove/fh_commons/blob/main/fh_commons/form.py#L19"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_file_input

>      get_file_input (label_text, id, **kwargs)

``` python
get_file_input('Select csv/excel for upload',id='sdf')
```

<form enctype="multipart/form-data"><label for="sdf" class="form-label">Select csv/excel for upload</label>  <input type="file" id="sdf" class="form-control" name="sdf">
</form><script>if (window.htmx) htmx.process(document.body)</script>

### Receive file

------------------------------------------------------------------------

<a
href="https://github.com/sky1ove/fh_commons/blob/main/fh_commons/form.py#L27"
target="_blank" style="float:right; font-size:smaller">source</a>

### bytes2df

>      bytes2df (bytes_data, file_type)

### Example

``` python
@rt
def file_upload(req):
    add = get_file_input(
        'Upload your csv or excel',
        id='myFile',post=preview, target_id='content',hx_trigger='change')
    
    example_file = A(Small('Download Example File'), href=req.url_for('download_example'),download='example.csv')
    
    return Group(add,example_file), Div(id='content')

@app.get
def download_example():
    return FileResponse('data/example.csv')

@app.post
async def preview(sess, myFile:UploadFile):
    filename = myFile.filename

    if filename.endswith('.csv'):
        file_type = 'csv'
    elif filename.endswith(('.xls', '.xlsx')):
        file_type = 'excel'
    else:
        return add_toast(sess, "Please upload a csv or excel file", "error")
        
    # Data as byte string
    bytes_data = await myFile.read()
    df = bytes2df(bytes_data,file_type)
    
    if len(df)>100_000:
        return add_toast(sess, "Exceed 100,000 lines, please use python api for large file", "warning")
    
    return df2html(df.head())
```

``` python
htmx(url,'/file_upload')
```

<iframe src="https://4687-3-81-185-19.ngrok-free.app/file_upload" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

## Input text

------------------------------------------------------------------------

<a
href="https://github.com/sky1ove/fh_commons/blob/main/fh_commons/form.py#L36"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_input

>      get_input (label_text, id, cls=None, type='text', **kwargs)

``` python
get_input('Gene ID',id='aa')
```

<span class="form-floating None">  <input type="text" placeholder="Gene ID" id="aa" class="form-control" name="aa">
<label for="aa">Gene ID</label></span><script>if (window.htmx) htmx.process(document.body)</script>

------------------------------------------------------------------------

<a
href="https://github.com/sky1ove/fh_commons/blob/main/fh_commons/form.py#L43"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_button

>      get_button (text, cls, **kwargs)

``` python
Form(get_input('sdf','a',cls='col-3'),get_button('aaa',cls='col-1'),cls='row g-2')
```

<form enctype="multipart/form-data" class="row g-2"><span class="form-floating col-3">    <input type="text" placeholder="sdf" id="a" class="form-control" name="a">
<label for="a">sdf</label></span><button type="button" class="btn btn-primary col-1">aaa</button></form><script>if (window.htmx) htmx.process(document.body)</script>

------------------------------------------------------------------------

<a
href="https://github.com/sky1ove/fh_commons/blob/main/fh_commons/form.py#L47"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_input_list

>      get_input_list (label_text, input_list, id, cls=None, type='text',
>                      **kwargs)

``` python
get_input_list('Select item', ['a','b','c','d'],id='select')
```

<div class="form-floating position-relative None">
  <input type="text" placeholder="Select item" autocomplete="off" id="select" class="form-control" name="select">
<label for="select">Select item</label>  <div id="select-dropdown" class="dropdown-menu">
    <div data-value="a" class="dropdown-item">a</div>
    <div data-value="b" class="dropdown-item">b</div>
    <div data-value="c" class="dropdown-item">c</div>
    <div data-value="d" class="dropdown-item">d</div>
  </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        setupAutocomplete('#select', '#select-dropdown');
    });
    </script><script>if (window.htmx) htmx.process(document.body)</script>

## TextArea

``` python
Textarea(id='s', placeholder='sdf', cls='form-control',rows=10)
```

<textarea placeholder="sdf" rows="10" id="s" class="form-control" name="s"></textarea><script>if (window.htmx) htmx.process(document.body)</script>

## Select (default is first)

------------------------------------------------------------------------

<a
href="https://github.com/sky1ove/fh_commons/blob/main/fh_commons/form.py#L68"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_select

>      get_select (label_text, option_list, id, cls=None, **kwargs)

*The first item in the option_list is the default*

## Select

------------------------------------------------------------------------

<a
href="https://github.com/sky1ove/fh_commons/blob/main/fh_commons/form.py#L83"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_select_simple

>      get_select_simple (label_text, select_list, id, cls=None)

``` python
get_select_simple('select one', ['a','b','c'],id='ssdf')
```

<div>
<select id="ssdf" class="form-select" name="ssdf"><option selected disabled>select one</option><option value="a">a</option><option value="b">b</option><option value="c">c</option></select></div>
<script>if (window.htmx) htmx.process(document.body)</script>

## Select multiple

------------------------------------------------------------------------

<a
href="https://github.com/sky1ove/fh_commons/blob/main/fh_commons/form.py#L91"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_select_simple_multiple

>      get_select_simple_multiple (label_text, select_list, id, cls=None)

``` python
get_select_simple_multiple('select one', ['a','b','c'],id='ssss')
```

<div>
<select multiple id="ssss" class="form-select" name="ssss"><option selected disabled>select one</option><option value="a">a</option><option value="b">b</option><option value="c">c</option></select></div>
<script>if (window.htmx) htmx.process(document.body)</script>

## Spinner

------------------------------------------------------------------------

<a
href="https://github.com/sky1ove/fh_commons/blob/main/fh_commons/form.py#L100"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_spinner

>      get_spinner (id, cls='d-flex justify-content-center')

``` python
get_spinner(id='sdf')
```

<div class="d-flex justify-content-center">
  <div role="status" id="sdf" class="htmx-indicator spinner-border">
<span class="visually-hidden">Loading...</span>  </div>
</div>
<script>if (window.htmx) htmx.process(document.body)</script>

Example:

``` python
# @app.post
# def example():
#     ...
#     send_select = Form(
#             Hidden(value=df.to_json(),id='upload_df'),
#             Div(select_list,button,cls='row g-2 align-items-center'),
#             post=calculate,
#             target_id='result',
#             hx_indicator='#spinner',
#         )
    
#     spinner=get_spinner(id='spinner')
    
#     return send_select, spinner, ...
```

## End

``` python
server.stop()
kill_ngrok()
```

    ngrok tunnel killed
